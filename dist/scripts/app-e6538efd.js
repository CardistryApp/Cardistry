"use strict";angular.module("cardistry",["ui.router","firebase","cardistry.cards","cardistry.main","angular-gestures"]).config(["$stateProvider","$urlRouterProvider",function(a,e){a.state("login",{url:"/",templateUrl:"app/partials/login.html",controller:"loginPageCtrl as login"}).state("home",{url:"/home",templateUrl:"app/partials/home.html",controller:"MainCtrl as app",onEnter:["Auth","$modal",function(a,e){this.user="";var t=this;a.onAuth(function(a){t.user=a}),t.user.$loaded().then(function(){(null==t.user.hand||t.user.hand.length<10)&&(console.log(e),e.open({templateUrl:"app/partials/rules.html",backdrop:"static"}))})}]}).state("player",{url:"/player",templateUrl:"app/partials/player.html",controller:"PlayerCtrl as players",onEnter:["Auth","$modal",function(a,e){this.user="";var t=this;a.onAuth(function(a){t.user=a}),t.user.$loaded().then(function(){0==t.user.playerTutorial&&(console.log(e),e.open({templateUrl:"app/partials/playerTutorial.html",backdrop:"static"}))})}]}).state("czar",{url:"/czar",templateUrl:"app/partials/czar.html",controller:"PlayerCtrl as players",onEnter:["Auth","$modal",function(a,e){this.user="";var t=this;a.onAuth(function(a){t.user=a}),t.user.$loaded().then(function(){0==t.user.czarTutorial&&(console.log(e),e.open({templateUrl:"app/partials/czarTutorial.html",backdrop:"static"}))})}]}).state("about",{url:"/about",templateUrl:"app/partials/about.html"}),e.otherwise("/")}]),angular.module("cardistry.main",["cardistry.cards","firebase","angular-gestures","ui.bootstrap"]).constant("CONFIG",{Firebase:{baseUrl:"https://cardistry.firebaseio.com/gameDB"}}).controller("MainCtrl",["$firebase","Auth","$filter","Deck","$modal","$scope",function(a,e,t,r,s,i){var n=this;e.onAuth(function(a){n.user=a}),this.scoreSet=function(){n.user.dailyScore=0,n.user.weeklyScore=0,n.user.totalScore=0},this.slides=["slide1","slide2","slide3","slide4","slide5","slide6","slide7"],this.slideIndex=0,this.selection=this.slides[this.slideIndex],this.nextSlide=function(){this.slideIndex++,this.selection=this.slides[this.slideIndex]},this.prevSlide=function(){this.slideIndex--,this.selection=this.slides[this.slideIndex]},this.dealIn=function(){r.load().then(r.shuffle).then(function(a){n.user.deck=a,n.user.hand=r.nextWhite(n.user.deck.white,10),n.user.$save()})},this.closeModal=function(){i.$close()},this.playTutNo=function(){n.user.playerTutorial=!0,n.user.$save(),this.closeModal()},this.czarTutNo=function(){n.user.czarTutorial=!0,n.user.$save(),this.closeModal()},this.newPlayer=function(){this.dealIn(),this.scoreSet(),n.user.playerTutorial=!1,n.user.czarTutorial=!1,i.$close()},this.getCard=function(a){console.log(n.user.hand),n.user.hand=n.user.hand.concat(r.nextWhite(this.user.deck.white,a)),n.user.$save()}}]).controller("PlayerCtrl",["$filter","Auth","Deck","FirebaseUrl","$firebase",function(a,e,t,r,s){var i=this;e.onAuth(function(a){i.user=a}),console.log(i.user);var n=r.child("players"),l=s(n),o=r.child("cardCzar"),c=s(o);this.hand=i.user.hand,this.cardIndex=0,this.chosenCard=c.$asArray(),this.chosenCardObj=c.$asObject(),this.playersObj=l.$asObject(),console.log(this.playersObj),this.next=function(){i.cardIndex>=i.user.hand.length-1?this.cardIndex=0:this.cardIndex++},this.czarIndex=0,i.chosenCard.$loaded().then(function(){i.czarIndex=i.chosenCard.length-1}),this.prev=function(){i.cardIndex<=0?this.cardIndex=9:this.cardIndex--},this.playCard=function(a){i.chosenCard.$add({question:i.user.deck.black[0].text,answer:a.text,user:i.user.$id,points:0});var e=i.user.hand.indexOf(a);i.user.hand.splice(e,1),i.user.deck.black.splice(0,1),i.user.hand=i.user.hand.concat(t.nextWhite(this.user.deck.white,1)),i.user.$save()},this.funny=function(a,e){this.chosenCardObj[this.chosenCard[e].$id].points++,this.chosenCardObj.$save(),this.playersObj[a].dailyScore++,this.playersObj.$save(),i.czarIndex--},this.notFunny=function(){i.czarIndex--}}]).controller("loginPageCtrl",["Auth",function(a){this.logIn=a.logIn,this.logOut=a.logOut}]).factory("FirebaseUrl",["CONFIG",function(a){return new Firebase(a.Firebase.baseUrl)}]).factory("Auth",["FirebaseUrl","$firebaseAuth","$firebase","$filter",function(a,e,t){function r(e){if(null===e)return null;var r=a.child("players").child(e.facebook.id);r.update({uid:e.uid,facebook:e.facebook,fullName:e.facebook.displayName,firstName:e.facebook.cachedUserProfile.first_name,avatarUrl:e.facebook.cachedUserProfile.picture.data.url});var r=t(a.child("players").child(e.facebook.id)).$asObject();return r}var s=e(a);return{onAuth:function(a){s.$onAuth(function(e){a(r(e))})},logIn:function(){return s.$authWithOAuthPopup("facebook")},logOut:function(){s.$unauth()}}}]),angular.module("cardistry.cards",[]).factory("Deck",["$http",function(a){var e={load:function(){return a.get("assets/data/cards.JSON").then(function(a){e.cards={},e.cards.white=[],e.cards.black=[];for(var t=a.data,r=0;r<t.length;r++)"A"===t[r].cardType?e.cards.white[t[r].id]={text:t[r].text,priority:0,expansion:t[r].expansion}:"Q"===t[r].cardType&&1===t[r].numAnswers&&(e.cards.black[t[r].id]={text:t[r].text,priority:0,expansion:t[r].expansion})})},shuffle:function(){return angular.forEach(e.cards.white,function(a){a.priority=Math.floor(Math.random()*(Object.keys(e.cards.white).length-1)+1)}),angular.forEach(e.cards.black,function(a){a.priority=Math.floor(Math.random()*(Object.keys(e.cards.black).length-1)+1)}),angular.forEach(e.cards,function(a){a.sort(function(a,e){return e.priority-a.priority})}),e.cards},nextWhite:function(a,e){var t=a.splice(0,e);return t},nextBlack:function(){}};return e}]),function(a){try{a=angular.module("cardistry")}catch(e){a=angular.module("cardistry",[])}a.run(["$templateCache",function(a){a.put("app/partials/about.html",'<div class="allabout"><div id="explaination"><h2>So... what is<br>Cards Against Singularity, anyway?</h2><br><h3>Well, start reading because we ain\'t doing it for ya!</h3><br><p>Who doesn\'t love Cards Against Humanity? We\'ll tell you who... the Introverts!<br><br></p><p>We just want to unite with other <span id="horrible">HORRIBLE</span> people but separately, in the safety of our own homes. Now we can, with Cards Against Singularity!</p><br></div><h3 class="rules">How To Play</h3><br><ol><li>Sign in via Facebook</li><br><li>Pick your Poison: Player or Czar.</li><br><li>As Player, you will view question cards and submit your best answer card from your hand... just waiting to be judged by others. No pressure though.</li><br><li>As Czar, you will view a collection of question/answer card pairs submitted by your fellow introverts and judge their humor. Funny? That player gets an awesome point. Not funny? Shoot them down and hope they cry</li></ol></div><ul><li class="back"><a ui-sref="home">Back</a></li></ul>')}])}(),function(a){try{a=angular.module("cardistry")}catch(e){a=angular.module("cardistry",[])}a.run(["$templateCache",function(a){a.put("app/partials/confirmationModal.html",'<div id="modal" ng-controller="PlayerCtrl as players"><div class="modal-header"><h3 class="modal-title">Play This Card?</h3></div><div class="modal-body"><ul><li ng-repeat="question in players.user.deck.black">{{question.text}}</li><li ng-repeat="card in players.user.hand" ng-show="players.cardIndex == $index">{{card.text}}</li></ul></div><div class="modal-footer"><button class="btn btn-primary" ng-click="players.PlayCard()">OK</button> <button class="btn btn-warning" ng-click="cancel()">Cancel</button></div></div>')}])}(),function(a){try{a=angular.module("cardistry")}catch(e){a=angular.module("cardistry",[])}a.run(["$templateCache",function(a){a.put("app/partials/czar.html",'<div id="player" ng-repeat="card in players.chosenCard" ng-show="players.czarIndex == $index"><ul id="questions"><li><section id="question" class="top"><h3>{{card.question}}</h3></section></li></ul><div class="controls"><div class="prev" hm-tap="players.notFunny()"></div><div class="next" hm-tap="players.funny(card.user, $index)"></div></div><h3 class="answer"><div class="ansWrap"><ul class="bottom img-fulid answerCards" id="czarAnswer"><li id="{{$index}}"><h3>{{card.answer}}</h3></li></ul></div><div class="back" id="pBack"><a ui-sref="home">Back</a></div></h3></div>')}])}(),function(a){try{a=angular.module("cardistry")}catch(e){a=angular.module("cardistry",[])}a.run(["$templateCache",function(a){a.put("app/partials/czarTutorial.html",'<div id="modal" ng-controller="MainCtrl as app"><div class="modal-header"><h3 class="modal-title">Czar Mode</h3></div><div class="modal-body" ng-switch="" on="app.selection"><section class="slides" ng-switch-when="slide1"><p><b>Funny:</b><br>To vote the question/answer combo as funny, tap the right half of the answer card<br><br><b>Not Funny:</b><br>If you don\'t find it funny, tap the left half of the answer card</p></section></div><div class="modal-footer"><button class="btn btn-default" id="deal" ng-click="app.closeModal()">Remind Me Later</button> <button class="btn btn-default" ng-click="app.czarTutNo()" ng-hide="app.selection === "slide7"">Got It!</button></div></div>')}])}(),function(a){try{a=angular.module("cardistry")}catch(e){a=angular.module("cardistry",[])}a.run(["$templateCache",function(a){a.put("app/partials/home.html",'<div class="account"><section id="accountInfo"><span id="greeting">Yo, {{app.user.firstName}}</span> <img id="profilePic" src="{{app.user.avatarUrl}}"><ul id="scoreboard"><li><span class="scoreFont">{{app.user.dailyScore}}</span> Daily</li><li><span class="scoreFont">{{app.user.weeklyScore}}</span> Weekly</li><li><span class="scoreFont">{{app.user.totalScore}}</span> Total</li></ul></section><ul id="gameChoices"><li class="bottom-left" id="cardCzar"><a ui-sref="czar">CZAR</a></li><li class="bottom-right" id="playerSelect"><a ui-sref="player">PLAYER</a></li></ul></div>')}])}(),function(a){try{a=angular.module("cardistry")}catch(e){a=angular.module("cardistry",[])}a.run(["$templateCache",function(a){a.put("app/partials/login.html",'<div class="auth"><ul><li class="top"><p>Cards Against Singularity</p></li><li class="bottom"><a ng-click="login.logIn()" ui-sref="home">SIGN IN</a></li></ul></div>')}])}(),function(a){try{a=angular.module("cardistry")}catch(e){a=angular.module("cardistry",[])}a.run(["$templateCache",function(a){a.put("app/partials/player.html",'<div id="player"><ul id="questions"><li><section id="question" class="top"><h3>{{players.user.deck.black[0].text}}</h3></section></li></ul><h3 class="answer"><div class="ansWrap"><ul class="bottom img-fulid answerCards"><div class="controls"><div class="prev" hm-tap="players.prev()"></div><div class="next" hm-tap="players.next()"></div></div><li ng-repeat="card in players.user.hand" ng-show="players.cardIndex == $index">{{card.text}}<div id="playCard" hm-tap="players.playCard(card)"></div></li></ul><div class="back" id="pBack"><a ui-sref="home">Back</a></div></div></h3></div>')}])}(),function(a){try{a=angular.module("cardistry")}catch(e){a=angular.module("cardistry",[])}a.run(["$templateCache",function(a){a.put("app/partials/playerTutorial.html",'<div id="modal" ng-controller="MainCtrl as app"><div class="modal-header"><h3 class="modal-title">Player Mode</h3></div><div class="modal-body" ng-switch="" on="app.selection"><section class="slides" ng-switch-when="slide1"><p><b>Viewing your Cards:</b><br>Tap the right half of the white answer card to cycle to the right, and the left half to cycle to the left<br><br><b>To Submit an Answer:</b><br>Tap the black question card</p></section></div><div class="modal-footer"><button class="btn btn-default" id="deal" ng-click="app.closeModal()">Remind Me Later</button> <button class="btn btn-default" ng-click="app.playTutNo()" ng-hide="app.selection === "slide7"">Got It!</button></div></div>')}])}(),function(a){try{a=angular.module("cardistry")}catch(e){a=angular.module("cardistry",[])}a.run(["$templateCache",function(a){a.put("app/partials/rules.html",'<div id="modal" ng-controller="MainCtrl as app"><div class="modal-header"><h3 class="modal-title">Welcome to Cards Against Singularity!</h3></div><div class="modal-body" ng-switch="" on="app.selection"><section class="slides" ng-switch-when="slide1"><p>A single player adaptation of everyone\'s favorite raunchy card game.<br><br>If you\'ve never played before, just think mad-libs with a foul mouth!</p></section><section class="slides" ng-switch-when="slide2"><p>There are two modes of play in Cards Against Singularity: Player and Czar</p></section><section class="slides" ng-switch-when="slide3"><p>In Player Mode, you have 10 white \'answer\' cards in your hand<br><br>Cycle through the cards and find the best answer to fill in the blank!</p></section><section class="slides" ng-switch-when="slide4"><p>Select your favorite answer and that Question/Answer combo is removed from your hand and submitted to the Czar pool<br><br>You are given another question card and a new answer card for your hand!</p></section><section class="slides" ng-switch-when="slide5"><p>In Czar mode, you hold the power to pad someone\'s ego or crush their spirits! (some results may vary)</p></section><section class="slides" ng-switch-when="slide6"><p>As Czar, you work your way through the pool of user submitted cards.<br><br>If you find it funny, give the user that submitted it a point<br><br>Not so funny? Deny the point and imagine their sad faces!</p></section><section class="slides" ng-switch-when="slide7"><p>So that\'s pretty much it! Press "Deal Me In" below to get your hand and remember:<br><br>Laughing at this game doesn\'t make you a horrible person... all the other stuff you do, however, is questionable</p></section></div><div class="modal-footer"><button class="btn btn-default" ng-click="app.prevSlide()" ng-hide="app.selection === "slide1"">Back!</button> <button class="btn btn-default" id="deal" ng-click="app.newPlayer()">Deal Me In!</button> <button class="btn btn-default" ng-click="app.nextSlide()" ng-hide="app.selection === "slide7"">Next!</button></div></div>')}])}();